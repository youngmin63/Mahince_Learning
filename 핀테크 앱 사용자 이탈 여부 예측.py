# -*- coding: utf-8 -*-
"""2churn_Template_with_Guide.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Y_U-K8OHANIrbQlOQ6rYjlsAf34DYBF7

# ğŸ“‰ í•€í…Œí¬ ì‚¬ìš©ì ì´íƒˆ ì˜ˆì¸¡ í…œí”Œë¦¿
ëª©ì : ì‚¬ìš©ì í–‰ë™ ë° ì„œë¹„ìŠ¤ ì´ìš© ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•€í…Œí¬ ì•± ì‚¬ìš©ì ì´íƒˆ(user_churn) ì—¬ë¶€ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¶„ë¥˜ ëª¨ë¸ì„ êµ¬ì¶•

###  í•€í…Œí¬ ì•± ì‚¬ìš©ì ì´íƒˆ ì˜ˆì¸¡

ğŸ“Œ **ì œì¶œ í•­ëª© êµ¬ì„± ì˜ˆì‹œ**

#### 1. ë°ì´í„° ì „ì²˜ë¦¬
- **ë¶ˆí•„ìš”í•œ ì»¬ëŸ¼ ì œê±°**  
  - `user_id`ëŠ” ì˜ˆì¸¡ì— ë¶ˆí•„ìš”í•˜ë¯€ë¡œ ì œê±°
- **ë²”ì£¼í˜• ë³€ìˆ˜ ì¸ì½”ë”©**  
  - `preferred_channel`, `membership_type`, `preferred_payment_type`, `app_security_enabled`, `in_app_support_use` ë“±
- **ì—°ì†í˜• ë³€ìˆ˜ ìŠ¤ì¼€ì¼ë§**  
  - `months_active`, `monthly_spending`, `total_transaction_amt` ë“±ì— `StandardScaler` ë˜ëŠ” `MinMaxScaler` ì ìš©
- **Xì™€ y ë¶„í• **  
  - íƒ€ê¹ƒ ë³€ìˆ˜ `user_churn` (0: ìœ ì§€, 1: ì´íƒˆ), ë‚˜ë¨¸ì§€ë¥¼ Xë¡œ ì„¤ì •

#### 2. íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ (EDA)
- ì´íƒˆ ê³ ê°ê³¼ ìœ ì§€ ê³ ê° ê°„ ì£¼ìš” ë³€ìˆ˜ ì°¨ì´ ì‹œê°í™”  
  - ì˜ˆ: `monthly_spending`, `months_active`, `membership_type`ë³„ ì´íƒˆë¥  ë¹„êµ
- ì´íƒˆ ë¹„ìœ¨, ë¶„í¬ ë¶ˆê· í˜• ì—¬ë¶€ í™•ì¸

#### 3. ëª¨ë¸ë§ ë° ì„±ëŠ¥ í‰ê°€
- 2ê°€ì§€ ì´ìƒ ë¶„ë¥˜ ëª¨ë¸ ì ìš©  
  - ì˜ˆ: `LogisticRegression`, `RandomForestClassifier` ë“±
- `train_test_split` í›„ ëª¨ë¸ í•™ìŠµ
- ì •í™•ë„(accuracy), ì¬í˜„ìœ¨(recall), ì •ë°€ë„(precision), F1-score ë“± í‰ê°€ ì§€í‘œ ì¶œë ¥
- **Confusion Matrix**ì™€ **ROC Curve** ì‹œê°í™”

#### 4. ë³€ìˆ˜ ì¤‘ìš”ë„ ë¶„ì„
- ëª¨ë¸ ê³„ìˆ˜ ë˜ëŠ” feature importanceë¥¼ ì‹œê°í™”
- `membership_type`, `preferred_channel`, `spending` ë“±ì´ ì´íƒˆì— ë¯¸ì¹˜ëŠ” ì˜í–¥ í•´ì„

#### 5. ê²°ê³¼ í•´ì„
- ê³ ê° ì´íƒˆì„ ì˜ˆì¸¡í•˜ëŠ” ë° ê°€ì¥ ì¤‘ìš”í•œ ë³€ìˆ˜ëŠ” ë¬´ì—‡ì¸ê°€?
- í•€í…Œí¬ ì•± ì‚¬ìš©ì ì´íƒˆì„ ì¤„ì´ê¸° ìœ„í•œ ì‹œì‚¬ì  ì œì‹œ

### âœ… ë³€ìˆ˜ ì„¤ëª… (í•€í…Œí¬ ì‚¬ìš©ì ì´íƒˆ ì˜ˆì¸¡ ë°ì´í„°)

| ë³€ìˆ˜ëª… | ì„¤ëª… |
|--------|------|
| `user_id` | ì‚¬ìš©ì ê³ ìœ  ID |
| `months_active` | í•€í…Œí¬ ì•±ì„ ì‚¬ìš©í•œ ëˆ„ì  ê°œì›” ìˆ˜ |
| `monthly_spending` | ì›” í‰ê·  ê²°ì œ ê¸ˆì•¡ |
| `total_transaction_amt` | ì „ì²´ ëˆ„ì  ê²°ì œ ê¸ˆì•¡ |
| `preferred_channel` | ì£¼ ì´ìš© ì±„ë„ (ì˜ˆ: mobile, web) |
| `membership_type` | ë©¤ë²„ì‹­ ìœ í˜• (free, standard, premium) |
| `preferred_payment_type` | ì„ í˜¸ ê²°ì œ ë°©ì‹ (card, simple_pay, auto_transfer ë“±) |
| `app_security_enabled` | ë³´ì•ˆ ê¸°ëŠ¥ ì‚¬ìš© ì—¬ë¶€ (ì˜ˆ: ìƒì²´ì¸ì¦ ë“±) |
| `in_app_support_use` | ì•± ë‚´ ê³ ê°ì§€ì› ê¸°ëŠ¥ ì´ìš© ì—¬ë¶€ |
| `user_churn` | ì‚¬ìš©ì ì´íƒˆ ì—¬ë¶€ (1: ì´íƒˆ, 0: ìœ ì§€) |
"""

# ğŸ“¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from Sklearn.linear_model import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix

# ğŸ“¥ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv('fintech_user_churn.csv')
df.head()

# ğŸ§¹ ì „ì²˜ë¦¬: ë²”ì£¼í˜• ë³€ìˆ˜ ì¸ì½”ë”© ë° ë¶„í• 
df_encoded = pd.get_dummies(df.drop('user_id', axis=1), drop_first=True)
X = df_encoded.drop('user_churn', axis=1)
y = df_encoded['user_churn']

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.3, random_state=42)

# ğŸ¤– ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ í•™ìŠµ ë° ì˜ˆì¸¡
model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

# ğŸ“Š í‰ê°€ ê²°ê³¼ ì¶œë ¥
print(classification_report(y_test, y_pred))
sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='d')
plt.title('Confusion Matrix')
plt.show()

model=RandomForestClassifier()
model.fit(X_train,y_train)
y_pred=model.predict(X_test)

"""## ğŸ“Œ ê²°ê³¼ í•´ì„
- ì–´ë–¤ ìš”ì¸ì´ ì´íƒˆ ì—¬ë¶€ì— ì˜í–¥ì„ ì£¼ì—ˆëŠ”ê°€?
- recallê³¼ precision ì¤‘ ì–´ë–¤ ì§€í‘œê°€ ë” ì¤‘ìš”í•œê°€?
- ëª¨ë¸ ì„±ëŠ¥ ê°œì„ ì„ ìœ„í•´ ì–´ë–¤ ê¸°ë²•ì„ ì¶”ê°€í•  ìˆ˜ ìˆì„ê¹Œ?
"""